# **Network**
> **네트워크의 기본적인 지식을 공부한 내용**
---
![네트워크 기본 구성](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FAs4JA%2FbtqxXIUxLlE%2FOgIbrqt2cELVz775FhpfVk%2Fimg.png)
* 위 사진은 네트워크 의 기본적인 구성임
---
## **네트워크(기술) 이란?**
* 서버와 클라이언트의 정보가 오고가는 다리 역할을 하는 기술의 총칭을 의미함
* 네트워크라는 말은 ```연결되어 있다``` 라는 뜻으로 컴퓨터 네트워크는 데이터를 케이블에 실어 나르는 것을 의미함
---
## **LAN**
* LAN이란 기업이나 조직 등 비교적 좁은 범위 안에 존재하는 컴퓨터 네트워크를 의미함
* LAN은 LAN케이블을 이용하여 데이터를 전송하는 유선LAN과 전파를 이용하여 데이터를 전송하는 무선LAN으로 구분됨
    * **LAN케이블 이란?**
        * LAN 케이블은 LAN을 연결하기 위한 케이블
    * **LAN스위치 란?**
        * LAN 스위치는 LAN을 구성하기 위한 네트워크 기기
---
## **네트워크 작동 원리**
* 네트워크는 OSI 참조 모델을 바탕으로 작동함
* OSI 참조 모델은 국제표준화기구(ISO) 가 컴퓨터 통신 기능을 계층 구조로 나눠서 정리한 모델로 일종의 통신 규칙 모음이라고 생각하면 됨
* 보통 ```OSI 7 계층``` 이라고 하는데 하위 계층(물리 계층) 부터 상위 계층(전송 계층) 으로 구성됨
---
## **OSI 7 계층**
* 제 1계층(물리 계층) : 네트워크 케이블의 재질이나 커넥터의 형식, 핀의 나열 방법 등 물리적인 요소를 모두 규정한다.
* 제 2계층(데이터 링크 계층) : 직접 연결된 기기 사이에 논리적인 전송로(데이터 링크)를 확립하는 방법을 규정한다.
* 제 3계층(네트워크 계층) : 동일 또는 다른 네트워크의 기기와 연결하기 위한 주소와 경로의 선택 방법을 규정한다.
* 제 4계층(전송 계층) : 데이터를 통신할 상대에게 확실하게 전달하는 방법을 규정한다.
* 제 5계층(세션 계층) : 데이터를 흘려보내는 논리적인 통신로(커넥션)의 확립과 연결 끊기에 대해 규정한다.
* 제 6계층(표현 계층) : 애플리케이션 데이터를 통신에 적합한 형태로 변환하는 방법을 규정한다.
* 제 7계층(응용 계층) : 애플리케이션 별로 서비스를 제공하는 방법을 규정한다.  

    |OSI 참조 모델|프로토콜|
    |:---:|:---:|
    |응용 계층 (제 7계층)|애플리케이션 프로토콜(HTTP 등)
    |표현 계층 (제 6계층)|애플리케이션 프로토콜(HTTP 등)
    |세션 계층 (제 5계층)|애플리케이션 프로토콜(HTTP 등)
    |전송 계층 (제 4계층)|TCP, UDP
    |네트워크 계층 (제 3계층)|IP, ICMP, ARP
    |데이터 링크 계층 (제 2계층)|이더넷
    |물리 계층 (제 1계층)|이더넷
---
## **프로토콜**
* 프로토콜이란 네트워크 통신을 위한 통신 규칙을 의미함
* 프로토콜의 역할은 데이터의 캡슐화와 캡슐 해제화를 하는 것
* 네트워크 통신에서 OSI 참조 모델의 계층을 넘어설 때마다 데이터를 캡슐에 넣거나 꺼냄
* 아래 사진은 프로토콜 캡슐화 / 캡슐 해제화 에 관한 사진임
![프토토콜 캡슐화/캡슐 해제화](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2F5cvbo%2FbtqxZShvgqi%2FIP30VHKYWP4pEMmERgRRPK%2Fimg.png)
---
## **이더넷**
* 이더넷은 OSI 제 1계층과 제 2계층의 기술 규격임
* 유선 네트워크의 경우 거의 대부분이 이더넷을 사용함
* 이더넷은 네트워크 계층으로부터 받은 데이터(패킷)에 프레임의 처음을 나타내는 프리앰블(preamble)과 목적지(수신자)와 출발지(송신자)를 나타내는 헤더, 비트 오류체크에 사용하는 FCS(Frame Check Squence)를 추가하여 프레임을 생성함
* 이더넷은 MAC 주소라는 48비트로 된 식별자를 사용하여 컴퓨터를 식별함
* 아래 사진은 프레임 구조에 관한 사진임
![프레임 구조](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FXW8SD%2FbtqxXbvNdiw%2FzfGRvmz6CQjWIL8S0R7I9K%2Fimg.png)
---
## **MAC 주소**
* MAC 주소란 데이터링크 계층(제 2계층) 에서 통신을 위해 사용되는 48비트로 된 식별자 임
* MAC 주소는 8비트 마다 하이픈(-) 이나 콜론(:) 으로 구분하여 16진수로 표기함
* 상위 24비트는 전기 및 전자관계 기술자 단체인 미국전기전자학회(IEEE)가 __기기의 제조업체 별로 할당한 제조업체 코드 : OUI__ 해당코드 로 제조업체를 알수 있음
* 하위 24비트는 제조업체가 기기 별로 고유한 값을 할당한 코드임
* NIC 에 할당되어 있는 MAC 주소는 전 세계에 하나밖에 없는 고유한 값임
* NIC(Network Interface Controller)란?
    * NIC은 컴퓨터를 네트워크에 연결하여 통신하기 위해 사용하는 하드웨어 장치임
    * 흔히 우리가 네트워크 카드, 랜 카드로 부르는 것이 NIC임
---
## **스위칭**
* 네트워크 스위치가 데이터 패킷 내 포함된 주소 정보에 따라 해당 입력 패킷을 출력 포트에 빠르게 접속 시키는 기능을 스위칭 이라고 함
* 쉽게 설명하면 네트워크 스위치가 수행하는 프레임 전송이 스위칭 임
* 네트워크 스위치 란?
    * 네트워크 스위치는 L2 (제 2계층, 데이터 링크 계층)에서 사용하는 네트워크 기기로 LAN 케이블을 통해 컴퓨터를 연결함
    * 네트워크 스위치는 프레임이 들어온 LAN 포트 번호와 그 프레임의 출발지 MAC 주소를 테이블로 만들어 일정 기간 동안 기억하며 불필요한 프레임 전송을 막고 이더넷 네트워크 통신의 효율을 향상 시키는 역할을 함 
    * 이때 LAN 포트 번호와 출발지 MAC 주소의 테이블을 MAC 주소 테이블이라고 함  

* MAC 주소 테이블의 예
    |MAC주소|포트|
    |:---:|:---:|
    |A|1|
    |B|1|
    |C|1|
---
## **IP**
* IP는 전송계층(제 4계층)으로부터 받은 데이터(세그먼트)에 IP 헤더를 붙여 패킷으로 만드는 역할을 수행함
* IP 헤더에는 여러 필드 값(버전, 헤더길이, 프로토콜 등), 출발지 IP주소, 도착지 IP주소가 들어감
* 아래 사진은 패킷의 구조를 나타낸 사진임
![패킷 구조](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2Fclznxf%2FbtqxX8Flgpb%2FbPLRu1V2pAiyrVcNOpXzW1%2Fimg.png)
* IP는 IP 주소라는 32비트로 된 식별번호를 사용하여 컴퓨터를 식별함
* IP주소는 8비트 마다 점(.)으로 구분하고 10진수로 표기함
* IP주소는 네트워크 분리 및 구분을 위해 서브넷 마스크라는 32비트로 된 값과 세트로 사용함
* IP주소는 서브넷 마스크로 분할된 네트워크부와 호스트부로 구성되어 있음
    * 네트워크부는 네트워크 자체를 나타냄
    * 호스트는 해당 네트워크에 연결되어 있는 단말을 나타냄
    * 서브넷 마스크는 연속된 1의 값이나 연속된 0의 값만 가질 수 있는데 이때 1의 값을 가지는 부분은 네트워크 부이고, 0의 값을 가지는 부분이 호스트부임
* 서브넷 마스크를 사용하는 이유 
    * 서브넷 마스크를 사용하는 이유는 IP 주소 자체가 개수가 제한되어 있고, 네트워크를 효율적으로 분배하기 위해서임 
    * 서브넷 마스크 원리는 서브네팅을 찾아보면 됨
---
## **라우팅**
* 라우팅 이란 라우터가 네트워크에서 패킷을 목적지까지 최적의 경로를 선택하는 과정임
* 라우터란 각 독립된 네트워크들을 연결할때 L3(제 3계층, 네트워크 계층) 에서 사용하는 네트워크 기기임
    * L3 장비이기 때문에 패킷을 전송함
* 라우터는 라우팅 테이블을 이용하여 패킷을 전송함
* 라우팅 테이블은 목적지 네트워크와 목적지 네트워크로 가기 위해 보내야 할 곳의 IP주소(넥스트 홉) 로 구성되어 있음
    * 넥스트 홉(Next hop) 이란 패킷이 목적지 네트워크까지 가기위해 도달하는 다음 라우터를 의미함
* 패킷이 목적지 까지 가는데 거치는 라우터 개수를 홉 수(hop count) 라고 함
* 라우터는 패킷을 받으면 해당 패킷의 목적지 IP 주소와 라우팅 테이블의 목적지 네트워크를 대조하여 해당 IP주소가 있으면 패킷을 전송하고 없으면 패킷을 폐기함
* 라우팅 에는 정적 라우팅과 동적 라우팅이 존재함
    * 정적 라우팅
        * 정적 라우팅 이란 수동으로 라우팅 테이블을 생성하는 방법
        * 목적지 네트워크와 넥스트 홉을 하나하나 설정
        * 정적 라우팅은 네트워크를 구성하는 모든 라우터에 대해 라우팅 설정이 필요
        * 설정을 알기 쉽고 관리하기 쉽기 때문에 소규모 네트워크 환경에서 주로 사용
    * 동적 라우팅
        * 동적 라우팅 이란 인접하는 라우터들이 라우팅 정보를 서로 교환하여 라우팅 테이블을 자동으로 만드는 방법
        * 라우팅 정보를 교환하기 위한 프로토콜을 라우팅 프로토콜이라고 함
        * 네트워크 환경의 변화대응과 장애 내구성 향상이 가능하기 때문에 중간부터 대규모 네트워크 환경에서 주로 사용함
---
## **ARP(Address Resolution Protocol)**
* ARP는 MAC주소와 IP주소를 협조하면서 이용할 수 있도록 물리와 놀리의 다리 역할을 함
* 즉, 물리적인 주소인 MAC주소와 논리적인 주소인 IP주소를 대응시키는 역할을 함
* 네트워크 통신을 하기 위해서는 제 3계층으로부터 받은 패킷을 프레임으로 만들어 케이블로 흘려보내야 하는데 이때 출발지 MAC주소는 자기 자신의 NIC에 쓰여 있는 MAC 주소라서 알 수 있지만 목적지 MAC주소는 알 수가 없음
* 이때 ARP를 이용하여 IP주소로부터 MAC주소를 구할 수 있음
* 과정은 ```ARP request -> ARP reply -> ARP 테이블 등록``` 순 임
* 동일 네트워크 상에서는 수집된 ARP테이블을 참고하여 프레임을 만듬
* 다른 네트워크 간 통신은 기본 게이트웨이 MAC주소를 ARP에서 조회하여 목적지 MAC주소를 등록함
* 기본게이트웨이는 자신 이외의 네트워크로 갈 때 사용하는 출구가 되는 IP 주소임
    * 보통 방화벽이나 라우터의 IP주소가 기본 게이트웨이가 되는 경우가 많음
* IP주소는 목적지까지 바뀌지 않지만 MAC주소는 NIC을 경유할 때 마다 바뀜
---
## **TCP/UDP**
* TCP(Transmission Control Protocol)
    * TCP는 전송 제어 프로토콜로 IP와 함께 TCP/IP로 불리며 제 4계층(전송 계층)에서 사용되는 프로토콜 임
    * TCP는 데이터를 송신할 때 마다 확인 응답을 주고 받는 절차가 있어서 통신의 신뢰성을 높임 
    * 웹이나 메일, 파일 공유 등과 같이 데이터를 누락시키고 싶지 않은 서비스에 주로 사용됨
* UDP(User Datagram Protocol)
    * UDP는 TCP와 함께 데이터 그램으로 알려진 단문 메시지를 교환하기 위해 사용하는 프로토콜 임
    * 데이터만 보내고 확인 응답과 같은 절차를 생략할 수 있으므로 통신의 신속성을 높임
    * 주로 DNS, VoIP 등에 사용 됨
* TCP와 UDP
    * TCP 와 UDP 모두 포트 번호로 서비스를 식별함 
    * 두 프로토콜을 구분하는 주요한 차이는 통신의 신뢰성이냐 신속성이냐 임 
    * 애플리케이션 데이터에 TCP 또는 UDP 헤더를 추가하여 TCP 세그먼트나 UDP 세그먼트가 만들어짐
---
## **포트 번호**
* 포트 번호는 컴퓨터 안에서 작동하는 애플리케이션을 식별하기 위해 사용하는 숫자임
* 포트번호는 0~65535(16비트 분)까지 숫자로 범위에 따라 용도가 정해져 있음
* 포트 번호는 세그먼트를 만들 때 헤더에 출발지 포트와 목적지 포트로 들어감
    * 0~1023
        * 잘 알려진 포트(well-known port) 라고 해서 웹 서버나 메일 서버 등 일반적인 서버 소프트웨어가 서비스 요청을 대기할 때 사용됨
    * 1024~49151
        * 등록된 포트(registered port)라고 해서 제조업체의 독자적인 서버 소프트웨어가 클라이언트 서비스 요청을 대기할 때 사용됨
    * 49152~65535
        * 동적 포트(dynamic port)로 서버가 클라이언트를 식별하기 위해 사용됨 (클라이언트에서 서버에 대해 요청을 보낼 때 출발지 포트로 랜덤으로 지정해서 보냄)
---
## **NAT/NAPT**
* NAT와 NAPT는 기업이나 가정의 LAN에서 사용하는 프라이빗 IP주소를 인터넷에서 사용하는 글로벌 IP주소로 변환하는 기술임
    * NAT(Network Address Translation)
        * AT 는 프라이빗 IP 주소와 글로벌 IP 주소를 일대일로 연결하여 변환함 
        * 하나의 프라이빗 IP 주소와 하나의 글로벌 IP 주소를 연결하는 것 
        * 주로 서버를 인터넷에 공개할 때 사용함
        * LAN 에서 인터넷으로 연결할 때는 출발지 IP 주소를 변환함 
        * 반대로 인터넷에서 LAN 으로 연결할 때는 목적지 IP 주소를 변환함
    * NAPT(Network Address Port Translation)
        *NAPT 는 프라이빗 IP 주소와 글로벌 IP 주소를 n 대 1로 연결하여 반환함 
        * NAPT 는 LAN 에서 인터넷에 엑세스 할 때 출발지 IP 주소 뿐만 아니라 출발지 포트 번호도 같이 반환함으로써 n 대 1 변환을 함 
        * 하나의 IP에 포트가 여러개이기 때문에 N 대 1이 가능함